<%# ナビゲーションバー(ログイン後) %>
<header class="navbar bg-primary p-4 flex items-center justify-between relative">
  <!-- 左側のロゴとリンク -->
  <div class="flex items-center space-x-4">
    <img src="<%= asset_path('favicon.ico') %>" alt="LeafWhisper Logo" class="h-8">
    <%= link_to 'LeafWhisper', root_path, class: "btn btn-ghost md:text-xl sm:text-xs font-bold" %>
    <div class="hidden lg:block">
      <%= render 'products/search_form', q: @q, url: search_products_path %>
    </div>
  </div>
  
  <!-- デスクトップ用メニュー -->
  <div class="hidden lg:flex lg:text-sm xl:text-base space-x-4 items-center">
    <ul class="flex space-x-4 items-center">
      <li><%= link_to t('navbar.search_cafes'), search_cafes_path, class: "text-white" %></li>
      <li><%= link_to t('navbar.logout'), destroy_user_session_path, class: "text-white", data: { turbo_method: :delete } %></li>
      <li class="relative">
        <details class="group">
          <summary class="cursor-pointer text-white"><%= current_user.display_name %><%= t('navbar.menu_suffix') %></summary>
          <ul class="absolute right-0 mt-2 w-48 bg-base-100 rounded shadow-lg hidden group-open:block">
            <li><%= link_to t('navbar.review_list'), reviews_user_path(current_user), class: "block px-4 py-2 hover:bg-gray-200" %></li>
            <li><%= link_to t('navbar.favorites_list'), favorites_path(current_user), class: "block px-4 py-2 hover:bg-gray-200" %></li>
            <li><%= link_to t('navbar.edit_profile'), edit_user_registration_path, class: "block px-4 py-2 hover:bg-gray-200" %></li>
            <li><%= link_to t('navbar.faq'), faqs_index_path, class: "block px-4 py-2 hover:bg-gray-200" %></li>
          </ul>
        </details>
      </li>
    </ul>

    <!-- 言語選択ドロップダウン -->
    <div class="relative">
      <details class="group">
        <summary class="cursor-pointer text-white flex items-center">
          <img src="https://img.icons8.com/?size=512&id=t3NE3BsOAQwq&format=png" class="w-5 h-5 mr-2" alt="Current Language" />
          <span class="text-white"><%= t('navbar.language') %></span>
        </summary>
        <ul class="absolute right-0 mt-2 w-28 bg-base-100 rounded shadow-lg hidden group-open:block">
          <li>
            <%= link_to url_for(locale: 'en'), class: "block px-4 py-2 hover:bg-gray-200" do %>
              English
            <% end %>
          </li>
          <li>
            <%= link_to url_for(locale: 'ja'), class: "block px-4 py-2 hover:bg-gray-200" do %>
              日本語
            <% end %>
          </li>
        </ul>
      </details>
    </div>
  </div>
  
  <!-- モバイル用ハンバーガーメニュー -->
  <div class="lg:hidden flex items-center space-x-2">
    <!-- 言語選択ドロップダウン (モバイル用) -->
    <details class="relative group">
      <summary class="cursor-pointer text-white flex items-center">
        <img src="https://img.icons8.com/?size=512&id=t3NE3BsOAQwq&format=png" class="w-5 h-5 mr-2" alt="Current Language" />
        <span class="text-white"><%= t('navbar.language') %></span>
      </summary>
      <ul class="absolute right-0 mt-2 w-28 bg-base-100 rounded shadow-lg hidden group-open:block">
        <li>
          <%= link_to url_for(locale: 'en'), class: "block px-4 py-2 hover:bg-gray-200" do %>
            English
          <% end %>
        </li>
        <li>
          <%= link_to url_for(locale: 'ja'), class: "block px-4 py-2 hover:bg-gray-200" do %>
            日本語
          <% end %>
        </li>
      </ul>
    </details>
    
    <!-- ハンバーガーメニュー -->
    <button id="menu-toggle" class="text-white focus:outline-none">
      <i class="fas fa-bars fa-lg"></i>
    </button>
  </div>
</header>

<!-- モバイルメニュー -->
<div id="mobile-menu" class="hidden lg:hidden bg-primary p-4">
  <ul class="flex flex-col space-y-2">
    <li><%= render 'products/search_form', q: @q, url: search_products_path, class: "w-full" %></li>
    <li><%= link_to t('navbar.search_cafes'), search_cafes_path, class: "text-white" %></li>
    <li><%= link_to t('navbar.logout'), destroy_user_session_path, class: "text-white", data: { turbo_method: :delete } %></li>
    <li class="relative">
      <details class="group">
        <summary class="cursor-pointer text-white"><%= current_user.display_name %><%= t('navbar.menu_suffix') %></summary>
        <ul class="bg-base-100 rounded p-2 mt-2 hidden group-open:block">
          <li><%= link_to t('navbar.review_list'), reviews_user_path(current_user), class: "block px-2 py-1 hover:bg-gray-200" %></li>
          <li><%= link_to t('navbar.favorites_list'), favorites_path(current_user), class: "block px-2 py-1 hover:bg-gray-200" %></li>
          <li><%= link_to t('navbar.edit_profile'), edit_user_registration_path, class: "block px-4 py-2 hover:bg-gray-200" %></li>
          <li><%= link_to t('navbar.faq'), faqs_index_path, class: "block px-2 py-1 hover:bg-gray-200" %></li>
        </ul>
      </details>
    </li>
  </ul>
</div>
